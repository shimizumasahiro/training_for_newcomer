# 2 RNA二次構造処理

一本鎖RNAは自分自身で塩基対を形成することで高次構造を作る。この課題では、二次構造に着目した処理を行う。



## 2-1 塩基対を形成しうる場所の網羅的探索（自動テスト対象）
RNAの中で、塩基対を形成する可能性のあるペアを列挙せよ。ただし、ここでは塩基対を形成するのは A-U, G-C の2種類だけであるとする。

例
```
入力： 文字列 "AUCGCCAU"
出力： [(1,2), (1,8), (2,7), (3,4), (4,5), (4,6), (7,8)]
  - 出力は全て (i, j) ただし i < j とすること。
  - 塩基配列の座標は 1-origin であるとする
```

## 2-2 一定以上離れた塩基対のみを列挙する（自動テスト対象）

塩基対を形成するには、立体構造的には「逆向きに」「向き合う」ような位置に互いに配置される必要がある。このような立体構造を作るには、4塩基以上、塩基対を形成する塩基ペアが離れているべきである。
2-1の出力から、不適切な塩基対を削除したものを出力せよ。

<img src="https://user-images.githubusercontent.com/6902135/229429984-522e3c05-84db-4df0-8366-d6a572d06a1d.png" style="width:400px">

あるRNAの立体構造 (PDBID: 4GXY)。黄色部分が塩基対を形成、赤色の部分が折り返し領域（ヘアピン）

例
```
入力： 文字列 "AUCGCCAU"
出力： [(1,8), (2,7)]
  - 出力は全て (i, j) ただし i < j とすること。
  - 塩基配列の座標は 1-origin であるとする
```

## 2-3 連続で塩基対を形成する領域の検出（自動テスト対象）

RNAの内部の「ステム」構造は単一塩基対で形成されるわけではなく、連続した複数の塩基対で形成される。


入力として与えられた配列ファイルと、連続塩基数 `l` を引数として、ステムを構成しうる領域を全て検出せよ。連続した塩基対を形成する場合はDNAと同様、逆相補鎖と結合するので互いに逆順になることに注意せよ。

例
```
入力： 文字列 "AUCGCCAU"、最低連続塩基対長 l = 2
出力： [(1,8,2)]
  1つのタプルは「連続塩基対の開始点その1」「連続塩基対の開始点その2」「連続塩基数」から構成される。
  (1,8,2) の場合、 1-8, 2-7 の2つの塩基対が連続していることを意味する。
```

## 2-4 RNA二次構造の Dot-Bracket Notation（自動テスト対象）

RNA二次構造を表現する方法として、 Dot-Bracket Notation が広く用いられている。2-3 までで得られた結果をDot-Bracket Notationで表現せよ。

例
```
入力： 文字列 "AUCGCCAU"、最低連続塩基対長 l = 2
出力： "((....))"
```

なお、この Dot-Bracket Notation を [このサイト](http://rna.tbi.univie.ac.at/forna/) を使って描画すると、以下のようになる。

<img src="https://user-images.githubusercontent.com/6902135/229327405-6997c08f-4767-42ec-9d8d-cc4770d6d377.svg" style="width:300px">

## 2-5 実データへの適用と問題点の指摘

アンジオポエチン様タンパク質のメッセンジャーRNA (mRNA) 配列 `data/NM_014495.4.fasta` （ただし、mRNAのウラシル `U` の場所がチミン `T` で表現されていることに注意）を用いて同様の計算を行え。

実行した結果として、問題が発生する可能性がある（問題が発生すると思われる）。「どのような問題が発生するか」、「どのような回避・改善策が考えられるか」を指摘・提案せよ。